# ELK Stack vs Prometheus + Grafana

###  ELK Stack

- 분석 및 저장 기능을 담당하는 **ElasticSearch**, 수집 기능을 하는 **Logstash**, 이를 시각화하는 도구인 **Kibana**의 앞글자만 딴 단어

<br>

1. Elasticsearch – 검색 및 분석 엔진 (데이터 저장 및 조회)
2. Logstash – 로그 수집 및 처리 파이프라인 (데이터 수집 및 가공)
3. Kibana – 데이터 시각화 도구 (데이터 시각화 및 대시보드)

```
                               │
                               ▼
          ┌─────────────────────────────┐
          │        Filebeat 또는         │ ← log 수집 (가볍고 빠름)
          │        Logstash             │ ← log 수집 + 변환/필터 (더 강력함)
          └─────────────────────────────┘
                               │
                               ▼
              ┌────────────────────────┐
              │    Elasticsearch       │ ← 로그 저장 및 인덱싱
              └────────────────────────┘
                               │
                               ▼
              ┌────────────────────────┐
              │        Kibana          │ ← 로그 시각화, 검색, 대시보드
              └────────────────────────┘
```

장점

- 접근성 & 사용성
  - ELK는 오픈소스를 내려받아 설치하는 것으로 구축이 완료된다
  - 그 외의 별도의 추가적인 개발 과정이 필요없기 때문에 접근성이 뛰어나다
- 속도
  - Elasticsearch는 거의 실시간 (Real-Time)에 가깝게 데이터를 처리할 수 있다

- 유연성
  - ELK는 각자의 기능을 담당하는 세가지의 모듈은 붙여서 만든다. 그렇기 때문에 그 기능만 담당할 수 있다면 얼마든지 모듈을 유연하게 변경할 수 있다

단점

- Logstash로 로그를 가공하면서 오버헤드가 많이 발생함. 이를 보완하기 위해 Beats 도구  탄생
  - **Beats :** 서버에 에이전트로 설치하여 다양한 유형의 데이터를 ElasticSearch 또는 Logstash에 전송하는 오픈 소스 데이터 발송자다.

<br>

### Prometheus + Grafana

1. Prometheus - Exporter로부터 메트릭을 **주기적으로 pull**해서 수집하고 저장함
2. Grafana - Prometheus에 저장된 데이터를 시각화하고, 대시보드와 알림 설정 등을 담당함

```bash
[ 시스템/애플리케이션 (메트릭 제공자) ]
        └─ node_exporter, cadvisor, app 자체 내장 메트릭 등
                               │
                               ▼
                  ┌──────────────────────┐
                  │     Prometheus       │  ← 메트릭 수집 + 저장
                  └──────────────────────┘
                               │
                               ▼
                  ┌──────────────────────┐
                  │       Grafana        │  ← 메트릭 시각화 대시보드
                  └──────────────────────┘
```

 특징

- 모니터링 데이터를 반영구적으로 저장할 수 있다. prometheus에서 data retention을 조절하면 되는데, 1y, 5y(1년, 5년) 처럼 기간을 정할 수도 있고, 100GB 처럼 용량으로 설정할 수도 있다.

- CPU, 메모리 사용량 같은 시스템 데이터 뿐만 아니라 Django, Docker, Minecraft Server 등 다양한 metrics를 저장할 수 있다.

- 알림을 받을 수 있다. 시스템에 문제가 생겨 설정한 값(예: Memory Usage가 90%일 때)을 넘었을 때 Slack으로 알림을 보내는 것이 가능하다.

<br>

### ELK Stack vs Prometheus + Grafana

- 둘 다 모니터링 도구라는 공통점이 있지만...

- **ELK는 로그를 전문**으로 하고 **Prometheus는 메트릭을 전문**으로 한다는 큰 차이점이 있다

  - 매트릭이란?

  - **시간에 따라 변하는 수치 정보 (시계열 데이터)**

  - | 항목                 | 예시 값     | 설명                           |
    | -------------------- | ----------- | ------------------------------ |
    | CPU 사용률           | 45%         | 현재 CPU가 얼마나 바쁜지       |
    | 메모리 사용량        | 3.2 GB      | 사용 중인 메모리 크기          |
    | 디스크 사용률        | 80%         | 디스크가 얼마나 찼는지         |
    | 네트워크 송신 바이트 | 1.2 MB/s    | 초당 얼마나 데이터 보냈는지    |
    | HTTP 요청 수         | 120 req/min | 1분 동안 몇 번 요청 들어왔는지 |
    | 에러율               | 1.5%        | 전체 요청 중 에러가 난 비율    |

<br>

> 시계열 데이터: 시간 순서에 따라 기록된 데이터들의 연속적인 집합

<br>

 매트릭 vs 로그

| 구분 | 메트릭                              | 로그                                     |
| ---- | ----------------------------------- | ---------------------------------------- |
| 형태 | 수치 데이터 (숫자 위주)             | 텍스트 데이터 (문장, JSON 등)            |
| 목적 | 시스템 상태 모니터링, 경고 트리거용 | 문제 발생 시 원인 분석, 상세한 기록 확인 |
| 예시 | CPU 55%, HTTP 요청 30개             | "2025-07-10 12:00:01 ERROR Something..." |
| 툴   | Prometheus, Grafana 등              | ELK Stack (Logstash, Elasticsearch 등)   |

<br>

비유하자면  
- **ELK Stack** = CCTV 영상 분석 (과거 로그 기반 분석, 검색에 강함)  
- **Prometheus + Grafana** = 생체 모니터링 장비 (실시간 모니터링 및 알람 중심)